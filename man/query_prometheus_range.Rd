% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prometheus.R
\name{query_prometheus_range}
\alias{query_prometheus_range}
\title{Query prometheus for a range of dates}
\usage{
query_prometheus_range(
  grafana_url = "https://grafana.openscapes.2i2c.cloud",
  grafana_token = Sys.getenv("GRAFANA_TOKEN"),
  prometheus_uid = get_default_prometheus_uid(grafana_url, grafana_token),
  query,
  start_time = end_time - 30,
  end_time = Sys.Date(),
  step
)
}
\arguments{
\item{grafana_url}{URL of the Grafana instance. Default
\verb{""https://grafana.openscapes.2i2c.cloud""}}

\item{grafana_token}{Authentication token for Grafana. By default reads from
the environment variable \code{GRAFANA_TOKEN}}

\item{prometheus_uid}{the uid of the prometheus datasource. By default, it
is discovered from the \code{grafana_url} using
the internal function \code{get_default_prometheus_uid()}}

\item{query}{Query in "PromQL"
(\href{https://prometheus.io/docs/prometheus/latest/querying/basics/}{Prometheus Query Language})}

\item{start_time}{Start of time range to query. Date or date-time object, or
character of the form "YYYY-MM-DD HH:MM:SS". Time components are optional.
Default is \code{end_time} - 30 days.}

\item{end_time}{End of time range to query. Date or date-time object, or
character of the form "YYYY-MM-DD HH:MM:SS". Time components are optional.
Default is today (\code{Sys.Date()})}

\item{step}{Time step in seconds, or a string formatted as \code{"*h*m*s"} Eg., 1
day would be \code{"24h0m0s"}.}
}
\value{
List containing the response from Prometheus, in the
\href{https://prometheus.io/docs/prometheus/latest/querying/api/#range-vectors}{range vector format}
}
\description{
Adapted from https://hackmd.io/NllqOUfaTLCXcDQPipr4rg
}
\examples{
\dontshow{if (FALSE) (if (getRversion() >= "3.4") withAutoprint else force)(\{ # examplesIf}
query_prometheus_range(
  query = "max(dirsize_total_size_bytes) by (directory, namespace)",
  start_time = "2024-01-01",
  end_time = "2024-05-28",
  step = 60 * 60 * 24
)
\dontshow{\}) # examplesIf}
}
